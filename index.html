<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ticâ€‘Tacâ€‘Toe â€” AI vs Human (Responsive)</title>
  <style>
    :root{
      --bg:#e4f80b; /* dark blue */
      --card:#e2fb06;
      --accent:#10b981; /* green */
      --muted:#94a3b8;
      --x-color:#ef4444;
      --o-color:#60a5fa;
      --cell-size: min(22vw, 80px);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;
      background:linear-gradient(180deg,var(--bg),#071025); color:#e6eef8;
      display:flex; align-items:center; justify-content:center; padding:20px; background-image: url(images789.jpeg);
    }

    .card{
      width:100%; max-width:420px; background:linear-gradient(180deg,var(--card),#f5a903);
      border-radius:14px; padding:18px; box-shadow:0 10px 30px rgba(244, 168, 4, 0.6);
    }

    h1{font-size:18px; margin:0 0 10px 0; text-align:center;color: black;}
    .controls{display:flex; gap:8px; justify-content:space-between; align-items:center; margin-bottom:12px,
    }

    .left-controls{display:flex; gap:8px; align-items:center}
    .btn{background:transparent; border:1px solid rgba(7, 145, 243, 0.81); padding:8px 10px; border-radius:10px; color:black; font-size:13px; cursor:pointer}
    .btn.primary{background:var(--accent); color:#f7c307; border:none}

    .status{font-size:14px; text-align:center; margin-bottom:12px; color:black}

    .board{
      display:grid; grid-template-columns:repeat(3, 1fr); gap:8px; justify-items:center; margin:0 auto 12px; width:calc(var(--cell-size)*3 + 16px);
    }

    .cell{
      width:var(--cell-size); height:var(--cell-size); background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      display:flex; align-items:center; justify-content:center; font-size:calc(var(--cell-size) * 0.5); border-radius:10px; cursor:pointer; user-select:none;
      transition:transform .08s ease, box-shadow .12s ease;
      box-shadow:inset -2px -2px  rgba(0, 0, 0, 0.25);
    }
    .cell:active{transform:scale(.98)}
    .cell.x{color:var(--x-color)}
    .cell.o{color:var(--o-color)}

    .row{display:flex}

    .small{font-size:12px; color:black}

    .footer{display:flex; gap:6px; justify-content:space-between; align-items:center}

    /* responsive tweaks */
    @media (max-width:360px){
      :root{--cell-size: min(24vw, 64px)}
      .card{padding:12px}
    }
  </style>
</head>
<body>
  <div class="card" role="application" aria-label="Tic Tac Toe" style="background-image:url(main.jpg)">
    <h1>Ticâ€‘Tacâ€‘Toe â€” AI vs Human</h1>

    <div class="controls">
      <div class="left-controls">
        <label class="small" for="firstSelect">Who plays first?</label>
        <select id="firstSelect" aria-label="who goes first" class="btn" style="padding:6px 8px;">
          <option value="human" style="color:black">Human (X)</option>
          <option value="ai" style="color:black">AI (X)</option>
        </select>
      </div>

      <div style="display:flex; gap:8px">
        <button id="resetBtn" class="btn">Reset</button>
        <button id="undoBtn" class="btn">Undo</button>
      </div>
    </div>

    <div id="status" class="status">Choose who goes first, then tap a cell to play.</div>

    <div id="board" class="board" role="grid" aria-label="tic tac toe board">
      <!-- cells injected by JS -->
    </div>

    <div class="footer small">
      <div id="score">Wins â€” You: 0 | AI: 0 | Draws: 0</div>
      <div id="hint" class="small">Tip: Tap the board to play.</div>
    </div>
  </div>

  <script>
    // Simple Tic-Tac-Toe with Minimax AI. Board index:
    // 0 1 2
    // 3 4 5
    // 6 7 8

    const boardEl = document.getElementById('board');
    const statusEl = document.getElementById('status');
    const resetBtn = document.getElementById('resetBtn');
    const undoBtn = document.getElementById('undoBtn');
    const firstSelect = document.getElementById('firstSelect');
    const scoreEl = document.getElementById('score');

    let board = Array(9).fill(null); // 'X' or 'O' or null
    let human = 'X';
    let ai = 'O';
    let current = 'X';
    let gameOver = false;
    let history = [];
    let scores = {human:0, ai:0, draw:0};

    // create cells
    for(let i=0;i<9;i++){
      const c = document.createElement('div');
      c.className = 'cell';
      c.dataset.index = i;
      c.setAttribute('role','button');
      c.setAttribute('aria-label', 'cell '+(i+1));
      c.addEventListener('click', onCellClick);
      boardEl.appendChild(c);
    }

    function render(){
      for(let i=0;i<9;i++){
        const el = boardEl.children[i];
        el.textContent = board[i] ? board[i] : '';
        el.classList.toggle('x', board[i]==='X');
        el.classList.toggle('o', board[i]==='O');
        el.style.pointerEvents = (board[i] || gameOver) ? 'none' : 'auto';
      }

      if(gameOver){
        const winner = checkWinner(board);
        if(winner === human){ statusEl.textContent = 'You win! ðŸŽ‰'; }
        else if(winner === ai){ statusEl.textContent = 'AI wins. Try again.'; }
        else{ statusEl.textContent = 'Draw.'; }
      } else {
        statusEl.textContent = (current === human) ? "Your turn (X)" : "AI is thinking...";
      }

      scoreEl.textContent = `Wins â€” You: ${scores.human} | AI: ${scores.ai} | Draws: ${scores.draw}`;
    }

    function onCellClick(e){
      const i = Number(e.currentTarget.dataset.index);
      if(gameOver || board[i]) return;
      makeMove(i, current);
    }

    function makeMove(i, player){
      if(board[i] || gameOver) return;
      history.push(board.slice());
      board[i] = player;
      // switch
      current = (player === 'X') ? 'O' : 'X';
      checkAndProceed();
      render();
      // if it's AI's turn and game not over, let AI play
      if(!gameOver && current === ai){
        // small delay so UI updates show "AI is thinking..."
        setTimeout(()=>{ aiTurn(); }, 180);
      }
    }

    function aiTurn(){
      const move = findBestMove(board, ai);
      if(move >= 0){ makeMove(move, ai); }
    }

    resetBtn.addEventListener('click', ()=>{
      startNewGame();
    });

    undoBtn.addEventListener('click', ()=>{
      if(history.length===0 || gameOver) return;
      board = history.pop();
      // set current based on counts
      const xCount = board.filter(v=>v==='X').length;
      const oCount = board.filter(v=>v==='O').length;
      current = (xCount<=oCount) ? 'X' : 'O';
      gameOver = false;
      render();
    });

    firstSelect.addEventListener('change', ()=>{
      const who = firstSelect.value; // 'human' or 'ai'
      if(who==='human'){ human='X'; ai='O'; }
      else { human='O'; ai='X'; }
      startNewGame();
    });

    function startNewGame(){
      board = Array(9).fill(null);
      history = [];
      gameOver = false;
      current = (human === 'X') ? 'X' : 'X'; // X always starts per rules
      // if AI is X and chosen to go first, let AI play
      if(ai === 'X'){
        // AI starts
        setTimeout(()=>{ aiTurn(); }, 160);
      }
      render();
    }

    // ---------- Game logic helpers ----------
    function checkWinner(b){
      const wins = [
        [0,1,2],[3,4,5],[6,7,8],
        [0,3,6],[1,4,7],[2,5,8],
        [0,4,8],[2,4,6]
      ];
      for(const [a,c,d] of wins){
        if(b[a] && b[a] === b[c] && b[a] === b[d]) return b[a];
      }
      if(b.every(Boolean)) return 'draw';
      return null;
    }

    // Minimax implementation
    function findBestMove(b, player){
      // returns index 0..8
      let bestVal = -Infinity;
      let bestMove = -1;
      for(let i=0;i<9;i++){
        if(!b[i]){
          b[i] = player;
          const moveVal = minimax(b, 0, false, player);
          b[i] = null;
          if(moveVal > bestVal){ bestVal = moveVal; bestMove = i; }
        }
      }
      return bestMove;
    }

    function minimax(b, depth, isMaximizing, playerSymbol){
      const opponent = (playerSymbol === 'X') ? 'O' : 'X';
      const winner = checkWinner(b);
      if(winner !== null){
        if(winner === playerSymbol) return 10 - depth;
        if(winner === opponent) return depth - 10;
        if(winner === 'draw') return 0;
      }

      if(isMaximizing){
        let best = -Infinity;
        for(let i=0;i<9;i++){
          if(!b[i]){
            b[i] = playerSymbol;
            best = Math.max(best, minimax(b, depth+1, false, playerSymbol));
            b[i] = null;
          }
        }
        return best;
      } else {
        let best = Infinity;
        for(let i=0;i<9;i++){
          if(!b[i]){
            b[i] = opponent;
            best = Math.min(best, minimax(b, depth+1, true, playerSymbol));
            b[i] = null;
          }
        }
        return best;
      }
    }

    function checkAndProceed(){
      const winner = checkWinner(board);
      if(winner){
        gameOver = true;
        if(winner === human) scores.human++;
        else if(winner === ai) scores.ai++;
        else if(winner === 'draw') scores.draw++;
      }
    }

    // start
    startNewGame();
    render();

    // keyboard accessibility: allow number keys 1-9
    window.addEventListener('keydown', e=>{
      if(gameOver) return;
      const key = e.key;
      if(!/^[1-9]$/.test(key)) return;
      const idx = Number(key)-1;
      if(current === human){ makeMove(idx, human); }
    });

  </script>
</body>
</html>
